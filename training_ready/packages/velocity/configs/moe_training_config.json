{
  "base_model": "LatitudeGames/Wayfarer-2-12B",
  "num_train_epochs": 3,
  "per_device_train_batch_size": 4,
  "gradient_accumulation_steps": 8,
  "learning_rate": 3e-4,
  "warmup_steps": 1000,
  "weight_decay": 0.01,
  "max_grad_norm": 1.0,
  
  "moe_config": {
    "num_experts": 4,
    "expert_domains": [
      "psychology",
      "mental_health",
      "bias_detection",
      "general_therapeutic"
    ],
    "expert_capacity": 2,
    "load_balancing_weight": 0.01,
    "router_z_loss_weight": 0.001
  },
  
  "lora_config": {
    "lora_r": 16,
    "lora_alpha": 32,
    "lora_dropout": 0.1,
    "lora_target_modules": ["q_proj", "v_proj", "k_proj", "o_proj"]
  },
  
  "context_config": {
    "max_position_embeddings": 8192,
    "training_max_length": 2048
  },
  
  "h100_optimizations": {
    "bf16": true,
    "gradient_checkpointing": true,
    "optim": "adamw_torch_fused",
    "dataloader_num_workers": 4,
    "dataloader_pin_memory": true,
    "group_by_length": true
  },
  
  "training_constraints": {
    "max_training_hours": 12,
    "checkpoint_interval_minutes": 30,
    "early_stopping_patience": 3
  },
  
  "logging": {
    "logging_steps": 10,
    "eval_steps": 500,
    "save_steps": 500,
    "save_total_limit": 5
  },

  "nemotron_teacher": {
    "enabled": false,
    "s3_path": "s3://pixel-data/nemotron3/eval/nemotron3_nano_eval_run1.jsonl",
    "max_samples": 2000
  }
}
